# 常见问题答疑 (FAQ-Lab2)

**Q: 继承树分析中，如有多个类继承深度大于等于5，需要报告所有继承深度大于等于5的类吗？**

A: 需要报告所有继承深度大于等于5的类。下面是一个例子（注意深度从0开始）：

```
A <|-- B <|-- C <|-- D <|-- E <|-- F <|-- G
```

你应当报告如下信息：

```
Inheritance Abuse: A <|-- B <|-- C <|-- D <|-- E <|-- F
Inheritance Abuse: A <|-- B <|-- C <|-- D <|-- E <|-- F <|-- G
```

---

**Q: 循环依赖检测中，对环的输出顺序有要求吗？**

A: 没有要求，测试代码中有对等价环的判断，大家可以仔细阅读框架中的测试代码。

---

**Q: 为什么在循环依赖分析中，要把继承、实现、关联、依赖关系都视为依赖关系？**

??? note "Answer by LLM ( DeepSeek-V3-0324 )"
    在循环依赖分析中，将继承、实现、关联、依赖等不同类别的 UML 关系统一视为“依赖关系”来处理，主要是出于以下几个关键原因：

    **1. 循环依赖的本质是“引用闭环”**

    无论哪种关系（继承、实现、关联等），只要类 A 直接或间接依赖类 B，而类 B 又反向依赖类 A，就会形成循环依赖。

    例如：

    继承：父类依赖子类（通过调用子类方法或属性），同时子类继承父类 → 循环。

    关联：类 A 持有类 B 的成员变量，类 B 又持有类 A 的成员变量 → 循环。

    统一视为依赖可以简化分析，聚焦于“是否存在闭环引用”，而不必区分具体关系类型。

    **2. 实际代码中所有关系最终表现为依赖**

    在代码层面，这些关系都会转化为某种形式的依赖：

    继承/实现：子类依赖父类或接口的定义（如方法调用、属性访问）。

    关联：通过成员变量、方法参数等直接持有对另一个类的引用。

    依赖：临时性的方法调用或参数传递。

    例如，Java 中 `class A extends B`（继承）和 `class A { B b; }`（关联）都会导致 A 编译时依赖 B。

    **3. 循环依赖的破坏性无关关系类型**

    循环依赖会导致：

    编译问题：如 C++ 的头文件循环包含、Java 的编译顺序问题。

    设计僵化：难以独立修改或复用模块。

    初始化问题：如 Spring 中循环依赖需特殊处理（构造函数注入会报错）。

    这些问题与具体是继承还是关联无关，而是由“双向依赖”本身引起。

    **4. 工具实现的简化需求**

    静态分析工具（如 Sonar、ArchUnit）需要统一处理依赖关系，否则需为每种关系单独设计检测逻辑，复杂度陡增。

    例如，工具会将以下关系均视为边，构建有向图检测环路：

    ```mermaid
    graph LR
    A --继承--> B
    B --关联--> C
    C --依赖--> A  # 形成循环
    ```

    **5. 设计原则的通用约束**
    无论是继承、组合还是依赖，单向依赖（如分层架构）是良好设计的基础。循环依赖违反这一原则，无论形式如何。

    例如：

    继承循环：父类调用子类方法（通过模板方法模式）可能合理，但需明确设计意图。

    关联循环：直接双向关联通常意味着设计缺陷（可引入中间类解耦）。

    例外情况
    某些关系可忽略：如接口实现（implements）通常不视为循环依赖，因为接口是抽象契约，无具体实现依赖。

    设计模式中的刻意循环：如观察者模式中 Subject 和 Observer 的双向引用，需通过上下文判断合理性。

    **总结**

    将各类关系统一为依赖关系，是为了聚焦循环引用问题的核心，而非被具体关系类型的语义差异干扰。在实际分析和工具实现中，这种简化能高效发现潜在设计问题，同时保持足够的准确性。

---

**Q: 卡在了90/95分，不知道怎么改了**

A: GradeScope上有一些隐藏的测试用例，难度较高，可能涉及循环依赖分析、提取依赖关系等等。同时，你应该注意避免输出重复的边。你可以使用大语言模型来生成一些测试用例对小组的代码进行自测，这有助于你发现问题。

我们对GradeScope上部分测试用例添加了更详细的报错提示，请注意查看。

---

**Q: 像这样的代码，需要报告对`T`的依赖/关联吗？**

```java
class A<T> {
    private T t;
}
```

A: 不需要，`T`是泛型类型，不是类，不能作为依赖/关联的类型。




